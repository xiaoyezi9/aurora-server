# API文档

- 接口基准地址：`http://localhost:8000
- 服务端已开启 CORS 跨域支持
- API V1 认证统一使用 Token 认证
- 需要授权的 API ，必须在请求头中使用 `Authorization` 字段提供 `token` 令牌

# 前端部分

## 用户

### 用户注册

- 请求路径：`/webadmin/register`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| username | 用户名   | 不能为空 |
| password | 密码     | 不能为空 |

> 服务器会默认给该用户给一个
>
> user_id:uuid.v1() //用户id
>
> user_create：创建时间
>
> nickname:该用户还没没有设置昵称
>
> avatar:url地址
>
> realstate:1 --默认未认证
>
> user_state

### 用户登录

- 请求路径：`/webadmin/login`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| username | 用户名   | 不能为空 |
| password | 密码     | 不能为空 |

### 获取通知消息

- 请求路径：`/web/getnotice`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明 | 备注    |
| ------ | -------- | ------- |
| num    |          | 默认为1 |

### 更改通知消息状态

- 请求路径：`/web/changenotice`
- 请求方法：`post`
- 请求参数

| 参数名    | 参数说明 |                             备注                             |
| --------- | -------- | :----------------------------------------------------------: |
| change    | 类型     | change -单个消息已读 changeall-所有消息已读 delete- 删除单个 deleteall-所有删除 |
| notice_id |          |                                                              |



### 搜索

- 请求路径：`/web/search`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明 | 备注     |
| ------ | -------- | -------- |
| search |          | 搜索内容 |

>数据库检索的是标题

### 获取轮播图

>调用后端部分的轮播图接口`/admin/carousellist`

### 获取活动列表

- 请求路径：`/web/webgetwebactivitylist`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明         | 备注           |
| -------- | ---------------- | -------------- |
| total    | 总计几条数据     | 默认0          |
| page     | 现在第几页       | 默认1          |
| pagesize | 一页显示多少数据 | 默认5          |
| label    | 活动分类         | 默认为空字符串 |

### 获取单个活动内容

- 请求路径：`/web/getactivitycontent`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明 | 备注 |
| ------ | -------- | ---- |
| id     | 活动Id   |      |

### 获取活动公告

- 请求路径：`/admin/announcementlist`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明 | 备注 |
| ------ | -------- | ---- |
| id     | 活动Id   |      |

### 参加活动

- 请求路径：`/web/setjoin`
- 请求方法：`post`
- 请求参数

| 参数名      | 参数说明     | 备注t           |
| ----------- | ------------ | --------------- |
| type        | 类型         | activitycontent |
| contentname | 活动标题     |                 |
| to_userid   | 活动发起者id |                 |
| contetid    | 活动id       |                 |

### 获取求助列表

- 请求路径：`/web/webgetwebhelplist`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明         | 备注           |
| -------- | ---------------- | -------------- |
| total    | 总计几条数据     | 默认0          |
| page     | 现在第几页       | 默认1          |
| pagesize | 一页显示多少数据 | 默认5          |
| label    | 求助分类         | 默认为空字符串 |
| tag      | 求助标签         |                |

### 获取文章列表

- 请求路径：`/web/getarticlelist`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明         | 备注           |
| -------- | ---------------- | -------------- |
| total    | 总计几条数据     | 默认0          |
| page     | 现在第几页       | 默认1          |
| pagesize | 一页显示多少数据 | 默认5          |
| label    | 文章分类         | 默认为空字符串 |

### 获取单个文章内容

- 请求路径：`/web/getarticlecontent`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明 | 备注 |
| ------ | -------- | ---- |
| id     | 文章Id   |      |

### 获取标签列表

- 请求路径：`/admin/lablelist`
- 请求方法：`post`
- 请求参数

| 参数名    | 参数说明 | 备注 |
| --------- | -------- | ---- |
| labe_name | 问答分类 |      |

### 获取评论列表

- 请求路径：`/admin/getcomment`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明                                | 备注 |
| ------ | --------------------------------------- | ---- |
| id     | 内容Id,可以为任意活动，文章，求助内容id |      |

### 获取回复

- 请求路径：`/web/getreply`
- 请求方法：`post`
- 请求参数

| 参数名     | 参数说明 | 备注 |
| ---------- | -------- | ---- |
| comment_id | 评论id   |      |

### 添加回复

- 请求路径：`/web/setreply`
- 请求方法：`post`
- 请求参数

| 参数名          | 参数说明 | 备注 |
| --------------- | -------- | ---- |
| comment_id      | 评论id   |      |
| touserid        |          |      |
| comment_content |          |      |
| router          |          |      |
| to_userid       |          |      |
| content_id      |          |      |
| contentname     |          |      |

![](../我的坚果云/pic/image-20230408095215421.png)



### 获取图表数据

- 请求路径：`/webadmin/getusernumbering `
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明 | 备注 |
| ------ | -------- | ---- |
| id     | 用户id   |      |

### 获取用户信息

- 请求路径：`/webadmin/getuser `
- 请求方法：`post`
- 无参数 --后端通过token获取

### 修改用户信息

- 请求路径：`/webadmin/updatauser `
- 请求方法：`post`
- 请求参数

| 参数名      | 参数说明       | 备注                               |
| ----------- | -------------- | ---------------------------------- |
| m           | student / user | 通过这个判断是实名认证还是修改信息 |
| avatar      |                | 非必须                             |
| nickname    |                | 非必须                             |
| qq          |                | 非必须                             |
| mail        |                | 非必须                             |
| phone       |                | 非必须                             |
| synopisi    | 简介           | 非必须                             |
| realname    | 真实姓名       | 非必须                             |
| studentid   | 身份证号       | 非必须                             |
| studentcard | 身份证图片     | 非必须                             |

## 用户求助管理

### 获取用户发布的求助

- 请求路径：`/webadmin/getwebhelplist `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

| 参数名   | 参数说明 | 备注 |
| -------- | -------- | ---- |
| page     |          |      |
| pagesize |          |      |

### 删除用户发布的求助

- 请求路径：`/webadmin/deletehelp `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

| 参数名  | 参数说明 | 备注 |
| ------- | -------- | ---- |
| help_id | id       |      |

### 获取用户发布的求助的详细内容

- 请求路径：`/webadmin/gethelpdetails `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

| 参数名 | 参数说明 | 备注 |
| ------ | -------- | ---- |
| id     | id       |      |

### 用户发布求助

- 请求路径：`/webadmin/createhelp `
- 请求方法：`post`
- 请求参数

参数太多，用图表示

![image-20230408112326462](../我的坚果云/pic/image-20230408112326462.png)

### 用户编辑求助

- 请求路径：`/webadmin/updatehelp  `
- 请求方法：`post`
- 请求参数

参数太多，用图表示

![image-20230408112624517](../我的坚果云/pic/image-20230408112624517.png)

## 用户文章管理

### 获取用户发布的文章

- 请求路径：`/webadmin/getwebhelplist `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

| 参数名   | 参数说明 | 备注 |
| -------- | -------- | ---- |
| page     |          |      |
| pagesize |          |      |

### 删除用户发布的文章

- 请求路径：`/webadmin/deletearticle `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

| 参数名     | 参数说明 | 备注 |
| ---------- | -------- | ---- |
| article_id | id       |      |

### 获取用户发布的文章的详细内容

- 请求路径：`/webadmin/getarticledetails `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

| 参数名 | 参数说明 | 备注 |
| ------ | -------- | ---- |
| id     | id       |      |

### 用户发布文章

- 请求路径：`/webadmin/createarticle `
- 请求方法：`post`
- 请求参数

参数太多，用图表示

![image-20230408115006927](../我的坚果云/pic/image-20230408115006927.png)

### 用户编辑文章

- 请求路径：`/webadmin/updatearticle  `
- 请求方法：`post`
- 请求参数

参数太多，用图表示

![image-20230408115049270](../我的坚果云/pic/image-20230408115049270.png)

## 用户活动管理

### 获取用户发布的活动

- 请求路径：`/webadmin/getwebactivitylist `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

| 参数名   | 参数说明 | 备注 |
| -------- | -------- | ---- |
| page     |          |      |
| pagesize |          |      |

### 获取用户参与的活动

- 请求路径：`/webadmin/joinslist `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

### 删除用户发布的活动

- 请求路径：`/webadmin/deleteactivity `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

| 参数名     | 参数说明 | 备注 |
| ---------- | -------- | ---- |
| article_id | id       |      |

### 获取用户发布的活动的详细内容

- 请求路径：`/webadmin/getarticledetails `
- 请求方法：`post`
- 请求参数

>服务器会通过token自动获取用户id，

| 参数名 | 参数说明 | 备注 |
| ------ | -------- | ---- |
| id     | id       |      |

### 用户发布活动

- 请求路径：`/webadmin/createactivity `
- 请求方法：`post`
- 请求参数

参数太多，用图表示

![image-20230408122509889](../我的坚果云/pic/image-20230408122509889.png)

### 用户编辑活动

- 请求路径：`/webadmin/updateactivity  `
- 请求方法：`post`
- 请求参数

参数太多，用图表示

![image-20230408122553464](../我的坚果云/pic/image-20230408122553464.png)



### 参加活动

- 请求路径：`/webadmin/setjoin  `
- 请求方法：`post`
- 请求参数

参数太多，用图表示

### 取消参加活动

- 请求路径：`/webadmin/deletejoin  `
- 请求方法：`post`
- 请求参数

| 参数名     | 参数说明 | 备注 |
| ---------- | -------- | ---- |
| article_id | id       |      |

### 获取活动公告列表

- 请求路径：`/admin/announcementlist  `
- 请求方法：`post`
- 请求参数

| 参数名     | 参数说明 | 备注   |
| ---------- | -------- | ------ |
| content_id | id       | 活动id |

### 发布活动公告

- 请求路径：`/admin/setannouncement  `
- 请求方法：`post`
- 请求参数

![image-20230408124519718](../我的坚果云/pic/image-20230408124519718.png)

type是activity

### 获取活动参与人员

- 请求路径：`/webadmin/getwebjoinslist  `
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明 | 备注 |
| ------ | -------- | ---- |
| id     | id       |      |

## 客服中心

### 发送反馈内容

- 请求路径：`/webadmin/createfankui  `
- 请求方法：`post`
- 请求参数

| 参数名         | 参数说明   | 备注 |
| -------------- | ---------- | ---- |
| fankui_content | 反馈内容   |      |
| fankui_user    | 反馈用户id |      |

### 举报

- 请求路径：`/webadmin/createjubao  `
- 请求方法：`post`
- 请求参数

![image-20230408130505244](../我的坚果云/pic/image-20230408130505244.png)

### 申诉

- 请求路径：`/webadmin/createshensu  `
- 请求方法：`post`
- 请求参数

![image-20230408131617481](../我的坚果云/pic/image-20230408131617481.png)

### 获取举报内容

- 请求路径：`/webadmin/jubaocontent  `
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明 | 备注 |
| ------ | -------- | ---- |
| id     |          |      |

# 后端部分

## 图表

- 请求路径：`/admin/numbering`
- 请求方法：`post`
- 无参数



## 管理员管理

### 管理员登陆

- 请求路径：`/admin/login`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| username | 用户名   | 不能为空 |
| password | 密码     | 不能为空 |

- 响应参数

| 参数名   | 参数说明 | 备注 |
| -------- | -------- | ---- |
| token    |          |      |
| userinfo |          |      |
|          |          |      |
|          |          |      |
|          |          |      |
|          |          |      |

### 管理员信息

- 请求路径：`/admin/getadmin`
- 请求方法：`post`
- 无参数--通过token获取

### 更新管理员信息

- 请求路径：`/admin/changeadminuser`
- 请求方法：`post`
- 请求参数

| 参数名      | 参数说明                                     | 备注     |
| ----------- | -------------------------------------------- | -------- |
| nickname    | 昵称（对于管理员来说就是修改管理员这个名称） | 不能为空 |
| user_id     | id                                           | 不能为空 |
| newpassword | 新密码                                       | 可以为空 |

返回参数

| 参数名      | 参数说明             | 备注           |
| ----------- | -------------------- | -------------- |
| isfk        | 反馈，举报管理       | 1-有权限，0-无 |
| isgl        | 轮播图，标签分类管理 | 1-有权限，0-无 |
| issh        | 内容审核管理         | 1-有权限，0-无 |
| isyh        | 用户认证，账号管理   | 1-有权限，0-无 |
| nickname    | 昵称                 |                |
| password    | 密码                 |                |
| user_state  | 账号状态             | 1-启用，0-停用 |
| user_id     | id                   |                |
| user_create | 创建时间             |                |

### 注册管理员

- 请求路径：`/admin/registered`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| username | 用户名   | 不能为空 |
| password | 密码     |          |

### 获取管理员列表

- 请求路径：`/admin/getadminlist`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明           | 备注     |
| -------- | ------------------ | -------- |
| total    | 总计几条数据       | 默认0    |
| page     | 现在第几页         | 默认1    |
| pagesize | 一页显示多少数据   | 默认10   |
| user     | 查询账号关键字     | 默认为空 |
| state    | 查询用户状态关键字 | 默认为空 |

### 修改密码

- 请求路径：`/admin/changepassword`

- 请求方法：`post`

- 请求参数

- 

- | 参数名      | 参数说明 | 备注                                |
  | ----------- | -------- | ----------------------------------- |
  | username    | 用户名   | 不能为空                            |
  | newpassword | 密码     |                                     |
  | type        | 账号类型 | adminadmin -管理员 ;adminuser -用户 |

### 删除管理员

- 请求路径：`/admin/`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明 | 备注             |
| -------- | -------- | ---------------- |
| user_id  | id       | 不能为空         |
| usertype |          | admin --管理员； |

### 更新管理员权限

- 请求路径：`/admin/changeadminstate`
- 请求方法：`post`
- 请求参数

| 参数名     | 参数说明                  | 备注           |
| ---------- | ------------------------- | -------------- |
| isfk       | 反馈，举报管理            | 1-有权限，0-无 |
| isgl       | 轮播图，标签分类管理      | 1-有权限，0-无 |
| issh       | 内容审核管理              | 1-有权限，0-无 |
| isyh       | 用户认证，账号管理        | 1-有权限，0-无 |
| user_state | 账号状态                  | 1-启用，0-停用 |
| user_id    | id                        |                |
| username   | 只有值为admin才能修改权限 |                |

## 用户管理

### 获取用户列表

- 请求路径：`/admin/getuserlist`
- 请求方法：`post`
- 请求参数

| 参数名    | 参数说明         | 备注                                         |
| --------- | ---------------- | -------------------------------------------- |
| total     | 总计几条数据     | 默认0                                        |
| page      | 现在第几页       | 默认1                                        |
| pagesize  | 一页显示多少数据 | 默认10                                       |
| user      | 查询账号关键字   | 默认为空                                     |
| realstate | 用户认证状态     | 1-未认证；2-待审核；3-通过认证；0-未通过认证 |

### 修改用户认证状态

- 请求路径：`/admin/changeuserstate`
- 请求方法：`post`
- 请求参数

| 参数名  | 参数说明      | 备注                                   |
| ------- | ------------- | -------------------------------------- |
| type    | 值为realstate | 只是方便sql查询语句，修改realstate字段 |
| state   |               | 3-通过认证；0-未通过认证               |
| user_id | id            |                                        |

### 控制用户账号封禁时间

- 请求路径：`/admin/changeactivationdate`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明 | 备注               |
| -------- | -------- | ------------------ |
| time     | 封禁时间 | 只需要传递天数即可 |
| jubao_id |          | 默认为空           |
| user_id  | id       |                    |

## 标签管理

### 获取标签列表

- 请求路径：`/admin/lablelist`
- 请求方法：`post`
- 请求参数

| 参数名    | 参数说明 | 备注           |
| --------- | -------- | -------------- |
| labe_name |          | 默认为空字符串 |

### 更新标签

- 请求路径：`/admin/changelable`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明 | 备注                                     |
| -------- | -------- | ---------------------------------------- |
| lable    | 标签数组 | 每次更新都是直接传入整个数组             |
| lable_id | 分类id   | 总共三个分类，每个分类有一个数组（标签） |



## 轮播图管理

### 获取轮播图列表

- 请求路径：`/admin/carousellist`
- 请求方法：`post`
- 无请求参数

### 更新轮播图

- 请求路径：`/admin/changecarousel`
- 请求方法：`post`
- 请求参数

| 参数名         | 参数说明       | 备注 |
| -------------- | -------------- | ---- |
| carousel_img   | 上传服务器地址 |      |
| carousel_url   | url没什么用    |      |
| carousel_title | 轮播图标题     |      |

### 删除轮播图

- 请求路径：`/admin/deletecarouse`
- 请求方法：`post`
- 请求参数

| 参数名      | 参数说明 | 备注 |
| ----------- | -------- | ---- |
| carousel_id |          |      |

## 审核管理

### 获取内容列表

- 请求路径：`/admin/getuserlist`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明                            | 备注                                 |
| -------- | ----------------------------------- | ------------------------------------ |
| total    | 总计几条数据                        | 默认0                                |
| page     | 现在第几页                          | 默认1                                |
| pagesize | 一页显示多少数据                    | 默认10                               |
| user     | 查询用户关键字                      | 默认为空                             |
| admin    | 查询审批管理员关键字                | 默认为空                             |
| seacrh   | 查询关键字                          | 默认为空                             |
| state    | 审核状态 --控制的是数据库中isPubilc | 0-待审核；1-审核通过 ；-1-审核未通过 |
| type     | 只是方便sql查询语句，修改哪个表     | 默认help 有activity,article,help     |

### 更新内容审核状态

- 请求路径：`/admin/changecontentstate`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明                            | 备注                                                         |
| ------ | ----------------------------------- | ------------------------------------------------------------ |
| id     | id                                  | 哪个模块(help,article,activity，comment，reply)的内容就传入哪个id |
| type   | 只是方便sql查询语句，修改哪个表     |                                                              |
| state  | 审核状态 --控制的是数据库中isPubilc | 0-待审核；1-审核通过 ；-1-审核未通过                         |

### 管理员删除内容

- 请求路径：`/admin/admindelete`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明                        | 备注                                                         |
| ------ | ------------------------------- | ------------------------------------------------------------ |
| id     | id                              | 哪个模块(help,article,activity，comment,reply)的内容就传入哪个id |
| type   | 只是方便sql查询语句，修改哪个表 |                                                              |

## 评论管理

### 获取评论

- 请求路径：`/admin/getcomment`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明             | 备注     |
| -------- | -------------------- | -------- |
| total    | 总计几条数据         | 默认0    |
| page     | 现在第几页           | 默认1    |
| pagesize | 一页显示多少数据     | 默认10   |
| admin    | 查询审批管理员关键字 | 默认为空 |
| state    | 查询审核状态关键字   | 默认为空 |

### 获取回复

- 请求路径：`/admin/getreply`
- 请求方法：`post`
- 请求参数

| 参数名     | 参数说明 | 备注 |
| ---------- | -------- | ---- |
| comment_id | 评论id   |      |



>审核评论跟删除评论与审核管理共用一个接口

## 反馈管理

### 获取反馈列表

- 请求路径：`/admin/kefullist`
- 请求方法：`post`
- 请求参数

| 参数名    | 参数说明                        | 备注                       |
| --------- | ------------------------------- | -------------------------- |
| total     | 总计几条数据                    | 默认0                      |
| page      | 现在第几页                      | 默认1                      |
| pagesize  | 一页显示多少数据                | 默认10                     |
| kefu_tpye | 只是方便sql查询语句，修改哪个表 |                            |
| state     | 状态                            | 0-未处理；1-已处理；2-标记 |
| id        |                                 | 默认为空                   |

### 更新状态

- 请求路径：`/admin/changkefustate`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明                        | 备注                         |
| ------ | ------------------------------- | ---------------------------- |
| id     | id                              | 哪个模块()的内容就传入哪个id |
| type   | 只是方便sql查询语句，修改哪个表 |                              |
| state  | 状态                            | 0-未处理；1-已处理；2-标记   |

### 删除反馈数据

- 请求路径：`/admin/deletekefu`
- 请求方法：`post`
- 请求参数

| 参数名 | 参数说明                        | 备注 |
| ------ | ------------------------------- | ---- |
| id     | 哪个模块()的内容就传入哪个id    |      |
| type   | 只是方便sql查询语句，修改哪个表 |      |

### 更新反馈结果

- 请求路径：`/admin/changresult`
- 请求方法：`post`
- 请求参数

| 参数名   | 参数说明 | 备注 |
| -------- | -------- | ---- |
| jubao_id | id       |      |
| result   |          |      |